echo "üßπ –ü–æ—á–∏–Ω–∞—é –ø—Ä–∏–±–∏—Ä–∞–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –≥—ñ–ª–æ–∫..."

# –ö—Ä–æ–∫ 1: –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î–º–æ —Å—Ç–∞–Ω –∑ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—î–º
echo "--> –û—Ç—Ä–∏–º—É—é –∞–∫—Ç—É–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω –∑ GitHub —Ç–∞ –≤–∏–¥–∞–ª—è—é –Ω–µ—ñ—Å–Ω—É—é—á—ñ –≤—ñ–¥–¥–∞–ª–µ–Ω—ñ –≥—ñ–ª–∫–∏..."
git fetch --prune

# –ö—Ä–æ–∫ 2: –ó–Ω–∞—Ö–æ–¥–∏–º–æ –ª–æ–∫–∞–ª—å–Ω—ñ –≥—ñ–ª–∫–∏, —è–∫—ñ –≤—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É–≤–∞–ª–∏ –≤–∂–µ –≤–∏–¥–∞–ª–µ–Ω—ñ –≥—ñ–ª–∫–∏
echo "--> –®—É–∫–∞—é –ª–æ–∫–∞–ª—å–Ω—ñ –≥—ñ–ª–∫–∏ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è..."
# `|| true` –∑–∞–ø–æ–±—ñ–≥–∞—î –ø–æ–º–∏–ª—Ü—ñ, —è–∫—â–æ grep –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ
STALE_BRANCHES=$(git branch -vv | grep ': gone]' | awk '{print $1}' || true)

if [ -z "$STALE_BRANCHES" ]; then
  echo "‚úÖ –ù–µ–º–∞—î –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö –≥—ñ–ª–æ–∫. –í–∞—à –ª–æ–∫–∞–ª—å–Ω–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —á–∏—Å—Ç–∏–π!"
else
  echo "--> –ë—É–¥—É—Ç—å –≤–∏–¥–∞–ª–µ–Ω—ñ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ –≥—ñ–ª–∫–∏:"
  # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ü–∏–∫–ª, —â–æ–± –≤–∏–≤–µ—Å—Ç–∏ –∫–æ–∂–Ω—É –≥—ñ–ª–∫—É –∑ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞ –¥–ª—è –Ω–∞–æ—á–Ω–æ—Å—Ç—ñ
  for BRANCH in $STALE_BRANCHES; do
    echo "    - $BRANCH"
  done
  
  echo "--> –í–∏–∫–æ–Ω—É—é –≤–∏–¥–∞–ª–µ–Ω–Ω—è..."
  # –ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–¥–∞—î–º–æ —Å–ø–∏—Å–æ–∫ –≥—ñ–ª–æ–∫ –∫–æ–º–∞–Ω–¥—ñ git branch -d
  echo "$STALE_BRANCHES" | xargs git branch -d
  echo "‚úÖ –ü—Ä–∏–±–∏—Ä–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
fi
